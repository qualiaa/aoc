#!/usr/bin/env bqn

StrToInt â† +âŸœ(10âŠ¸Ã—)Â´ âˆ˜ âŒ½ âˆ˜ -âŸœ'0'
numeric â† '0' + â†•10

input â† â€¢FLines "/dev/stdin"

# FIXME: Feel like this parsing could be less terrible
sides â† 1âŠ¸â†“ âˆ˜ ((+`) âˆ˜ (âˆ¨Â´Â¨) âˆ˜ ('|'â€¿':'âŠ¸=âŒœ)âŠ¸âŠ”)Â¨ input
digits â†  1âŠ¸â†“ âˆ˜ ((Â» âˆ˜ (Â¯1âŠ¸(+`) âˆ˜ Â¬ âˆ˜ -âŸœÂ») âˆ˜ (+`)âŠ¸Ã— âˆ˜ âˆŠâŸœnumeric)âŠ¸âŠ”)Â¨Â¨ sides

drawnâ€¿winners â† âŸ¨1,âˆ˜âŸ©âŠ¸â¥Š âŠ¸âˆ¾Â¨Ë > StrToIntÂ¨ âˆ˜ ((1âŠ¸â‰¤âˆ˜â‰ Â¨)âŠ¸/)Â¨Â¨ digits

win_counts â† drawn +Ëâˆ˜âˆŠË˜ winners

â€¢Show +Â´ (2âŠ¸â‹†Ã—â‰¥âŸœ0)Â¨ win_counts - 1

R â† {
  totalâ€¿future_counts â† ğ•©
  n â† âŠ‘ future_counts
  âŸ¨total + n, â‰ âˆ˜âŠ¢ âŠ¸â†‘âŸœ(ğ•¨ â¥Š n)âŠ¸+ 1â†“future_countsâŸ©
}

â€¢Show âŠ‘ 0â€¿(â¥ŠâŸœ1 â‰ drawn) RÂ´ âŒ½ win_counts

